{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useSelector,useDispatch}from'react-redux';import{useNavigate}from'react-router-dom';import{setVisitHistory}from'../features/User/UserSlice';import axios from'axios';import'../App.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AllURL=()=>{const userId=useSelector(state=>state.user.userId);const navigate=useNavigate();const dispatch=useDispatch();const[getUrls,setgetUrls]=useState(null);;const[loading,setLoading]=useState(false);const[error,setError]=useState('');const BASE_URL=process.env.BACKEND_URL||process.env.BACKEND_URL||'http://localhost:5000';useEffect(()=>{const getAllUrls=async()=>{if(!userId){setError('Please create an Account first');return;}setLoading(true);setError('');try{const response=await axios.get(\"\".concat(BASE_URL,\"/api/url/admin/all/\").concat(userId));setgetUrls(response.data);}catch(error){var _error$response,_error$response$data;setError(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.error)||'Error fetching analytics');}finally{setLoading(false);}};getAllUrls();},[userId]);const handledeleteUrl=async shortid=>{if(userId){try{const response=await axios.delete(\"\".concat(BASE_URL,\"/api/url/deleteUrl/\").concat(shortid),{data:{userId},// ✅ Pass userId in `data` for DELETE body\nheaders:{'Content-Type':'application/json'}});console.log('Item deleted successfully!',response.data.message);// Update your frontend state here (e.g., remove the item from the list)\n}catch(error){var _error$response2,_error$response2$data;const errorMsg=((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.error)||error.message;setError(\"Error deleting item: \".concat(errorMsg));}}};const handlegetVisitHistory=async visitHistory=>{dispatch(setVisitHistory({visitHistory}));navigate('/VisitHistory');};return/*#__PURE__*/_jsx(\"div\",{children:userId&&/*#__PURE__*/_jsxs(\"section\",{className:\"analytics-section\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Get All URLs Dashboard\"}),/*#__PURE__*/_jsx(\"div\",{id:\"getAllUrl\",children:getUrls&&getUrls.map((myURL,index)=>{return/*#__PURE__*/_jsxs(\"div\",{className:\"analytics-box\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Analytics for \",myURL.shortId]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Original URL:\"}),\" \",myURL.originalUrl]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Short URL:\"}),\" \",/*#__PURE__*/_jsxs(\"a\",{href:myURL.shortUrl,className:\"short-url\",children:[\" \",myURL.shortUrl]})]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Total Clicks:\"}),\" \",myURL.totalClicks]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Created At:\"}),\" \",new Date(myURL.createdAt).toLocaleString()]}),myURL.visitHistory&&myURL.visitHistory.length>0&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Recent Clicks:\"}),/*#__PURE__*/_jsxs(\"ul\",{style:{maxHeight:'200px',overflowY:'auto'},children:[myURL.visitHistory.slice(-5).map((visit,idx)=>/*#__PURE__*/_jsx(\"li\",{children:new Date(visit.timestamp).toLocaleString()},idx)),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handlegetVisitHistory(myURL.visitHistory),disabled:loading,className:\"btn btn-primary\",children:loading?'Geting...':'Get User History'})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handledeleteUrl(myURL.shortId),disabled:loading,className:\"btn btn-primary\",children:loading?'Deleting...':'Delete Short URL'}),error&&!index&&/*#__PURE__*/_jsx(\"p\",{className:\"error\",children:error})]},index);})})]})});};export default AllURL;","map":{"version":3,"names":["React","useEffect","useState","useSelector","useDispatch","useNavigate","setVisitHistory","axios","jsx","_jsx","jsxs","_jsxs","AllURL","userId","state","user","navigate","dispatch","getUrls","setgetUrls","loading","setLoading","error","setError","BASE_URL","process","env","BACKEND_URL","getAllUrls","response","get","concat","data","_error$response","_error$response$data","handledeleteUrl","shortid","delete","headers","console","log","message","_error$response2","_error$response2$data","errorMsg","handlegetVisitHistory","visitHistory","children","className","id","map","myURL","index","shortId","originalUrl","href","shortUrl","totalClicks","Date","createdAt","toLocaleString","length","style","maxHeight","overflowY","slice","visit","idx","timestamp","onClick","disabled"],"sources":["C:/Users/rajub/OneDrive/Documents/Projects/frontend/src/Components/AllURL.js"],"sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { setVisitHistory } from '../features/User/UserSlice';\r\nimport axios from 'axios';\r\nimport '../App.css'\r\nconst AllURL = () => {\r\n    const userId = useSelector((state) => state.user.userId);\r\n    const navigate = useNavigate();\r\n    const dispatch = useDispatch();\r\n    const [getUrls, setgetUrls] = useState(null);;\r\n    const [loading, setLoading] = useState(false);\r\n    const [error, setError] = useState('');\r\n    const BASE_URL = process.env.BACKEND_URL || process.env.BACKEND_URL || 'http://localhost:5000';\r\n    useEffect(() => {\r\n        const getAllUrls = async () => {\r\n            if (!userId) {\r\n                setError('Please create an Account first');\r\n                return;\r\n            }\r\n\r\n            setLoading(true);\r\n            setError('');\r\n\r\n            try {\r\n                const response = await axios.get(`${BASE_URL}/api/url/admin/all/${userId}`);\r\n                setgetUrls(response.data);\r\n            } catch (error) {\r\n                setError(error.response?.data?.error || 'Error fetching analytics');\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n        getAllUrls()\r\n    }, [userId]);\r\n\r\n    const handledeleteUrl = async (shortid) => {\r\n        if (userId) {\r\n            try {\r\n                const response = await axios.delete(`${BASE_URL}/api/url/deleteUrl/${shortid}`, {\r\n                    data: { userId }, // ✅ Pass userId in `data` for DELETE body\r\n                    headers: {\r\n                        'Content-Type': 'application/json'\r\n                    }\r\n                });\r\n\r\n                console.log('Item deleted successfully!', response.data.message);\r\n                // Update your frontend state here (e.g., remove the item from the list)\r\n            } catch (error) {\r\n                const errorMsg = error.response?.data?.error || error.message;\r\n                setError(`Error deleting item: ${errorMsg}`);\r\n            }\r\n        }\r\n    };\r\n\r\n    const handlegetVisitHistory = async (visitHistory) => {\r\n        dispatch(setVisitHistory({ visitHistory}))\r\n        navigate('/VisitHistory')\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            {(userId) && (\r\n                <section className=\"analytics-section\">\r\n                    <h2>Get All URLs Dashboard</h2>\r\n\r\n                    <div id='getAllUrl'>\r\n                        {getUrls && getUrls.map((myURL, index) => {\r\n\r\n                            return (\r\n                                <div className=\"analytics-box\" key={index}>\r\n                                    <h3>Analytics for {myURL.shortId}</h3>\r\n                                    <p>\r\n                                        <strong>Original URL:</strong> {myURL.originalUrl}\r\n                                    </p>\r\n                                    <p>\r\n                                        <strong>Short URL:</strong> <a href={myURL.shortUrl} className='short-url'> {myURL.shortUrl}</a>\r\n                                    </p>\r\n                                    <p>\r\n                                        <strong>Total Clicks:</strong> {myURL.totalClicks}\r\n                                    </p>\r\n                                    <p>\r\n                                        <strong>Created At:</strong> {new Date(myURL.createdAt).toLocaleString()}\r\n                                    </p>\r\n                                    {myURL.visitHistory && myURL.visitHistory.length > 0 && (\r\n                                        <div>\r\n                                            <h4>Recent Clicks:</h4>\r\n                                            <ul style={{ maxHeight: '200px', overflowY: 'auto' }}>\r\n                                                {myURL.visitHistory.slice(-5).map((visit, idx) => (\r\n                                                    <li key={idx}>\r\n                                                        {new Date(visit.timestamp).toLocaleString()}\r\n                                                    </li>\r\n                                                ))}\r\n                                                <button onClick={() => handlegetVisitHistory(myURL.visitHistory)} disabled={loading} className='btn btn-primary'>\r\n                                                    {/* Get All User History */}\r\n                                                    {loading ? 'Geting...' : 'Get User History'}\r\n                                                </button>\r\n                                            </ul>\r\n                                        </div>\r\n                                    )}\r\n                                    <button onClick={() => handledeleteUrl(myURL.shortId)} disabled={loading} className='btn btn-primary'>\r\n                                        {loading ? 'Deleting...' : 'Delete Short URL'}\r\n                                    </button>\r\n                                    {error && (!index) && <p className=\"error\">{error}</p>}\r\n                                </div>\r\n                            );\r\n                        })}\r\n\r\n                    </div>\r\n                </section>\r\n            )}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default AllURL\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}